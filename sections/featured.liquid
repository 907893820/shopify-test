{% assign b = section.blocks %}
{% assign s = section.settings %}

{{ 'components-featured.css' | asset_url | stylesheet_tag }}

<div class="featured">
    <h1>{{ s.title }}</h1>
    <ul class="featured-list">
        {% for block in b %}
        {% assign b_s = block.settings %}
            <li class="featured-item">
                <img
                    srcset="{%- if b_s.image.width >= 375 -%}{{ b_s.image | image_url: width: 375 }} 375w,{%- endif -%}
                      {%- if b_s.image.width >= 750 -%}{{ b_s.image | image_url: width: 750 }} 750w,{%- endif -%}
                      {%- if b_s.image.width >= 1100 -%}{{ b_s.image | image_url: width: 1100 }} 1100w,{%- endif -%}
                      {%- if b_s.image.width >= 1500 -%}{{ b_s.image | image_url: width: 1500 }} 1500w,{%- endif -%}
                      {%- if b_s.image.width >= 1780 -%}{{ b_s.image | image_url: width: 1780 }} 1780w,{%- endif -%}
                      {%- if b_s.image.width >= 2000 -%}{{ b_s.image | image_url: width: 2000 }} 2000w,{%- endif -%}
                      {%- if b_s.image.width >= 3000 -%}{{ b_s.image | image_url: width: 3000 }} 3000w,{%- endif -%}
                      {%- if b_s.image.width >= 3840 -%}{{ b_s.image | image_url: width: 3840 }} 3840w,{%- endif -%}
                      {{ b_s.image | image_url }} {{ b_s.image.width }}w"
                    sizes="100vw"
                    src="{{ b_s.image | image_url: width: 1500 }}"
                    loading="lazy"
                    alt="{{ b_s.image.alt | escape }}"
                    width="{{ b_s.image.width }}"
                    height="{{ b_s.image.width | divided_by: b_s.image.aspect_ratio }}"
                  >
            </li>
        {% endfor %}
    </div>
</div>

{% schema %}
    {
        "name":"featured",
        "tag": "section",
        "settings":[
            {
                "type":"header",
                "content":"文案配置"
            },
            {
                "type":"text",
                "id":"title",
                "label":"标题"
            }
        ],
        "blocks":[
            {
                "type":"image-test",
                "name": "图文",
                "limit":6,
                "settings":[
                    {
                        "type":"image_picker",
                        "id":"image",
                        "label":"图片选择"
                    }
                ]
            }
        ],
        "presets": [
            {
                "name": "featured",
                "blocks": [
                    {
                        "type": "image-test"
                    }
                ]
            }
        ]
    }
{% endschema %}